syntax = "proto3";
package cosmos_sdk.x.ibc.commitment.v1;

option go_package = "github.com/datachainlab/fabric-ibc/x/ibc/xx-fabric/types";

import "third_party/proto/gogoproto/gogo.proto";
import "commitment/types.proto";

message Header {
  ChaincodeHeader ChaincodeHeader = 1 [(gogoproto.nullable) = true];
  ChaincodeInfo   ChaincodeInfo   = 2 [(gogoproto.nullable) = true];
}

message ChaincodeHeader {
  Sequence sequence = 1 [(gogoproto.nullable) = false];
  Proof  proof      = 2 [(gogoproto.nullable) = false];
}

message ChaincodeInfo {
  string         channel_id         = 1;
  ChaincodeID    chaincode_id       = 2 [(gogoproto.nullable) = false];
  bytes          endorsement_policy = 3;
  repeated bytes signatures         = 4; // signatures are created by last endorsers
}

// ref. https://github.com/hyperledger/fabric-chaincode-java/blob/392cf9cb740c42e0376ecdbbb015285b5a74ba97/fabric-chaincode-protos/src/main/protos/peer/chaincode.proto#L21
message ChaincodeID {
  //deploy transaction will use the path
  string path = 1;

  //all other requests will use the name (really a hashcode) generated by
  //the deploy transaction
  string name = 2;

  //user friendly version name for the chaincode
  string version = 3;
}

message Prefix {
  bytes value = 1 [(gogoproto.moretags) = "yaml:\"value\""];
}

message Proof {
  option (gogoproto.equal) = true;
  
  bytes proposal = 1;
  uint32 ns_index = 2;
  uint32 write_set_index = 3;
  repeated bytes identities = 4;
  repeated bytes signatures = 5;
}
